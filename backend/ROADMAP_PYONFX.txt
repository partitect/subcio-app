Roadmap for PyonFX Migration & Preset System

Phase 1 – Finish Porting Existing Presets (short term)
- Implement remaining complex effects in pyonfx_effects.py: falling_heart, thunder_storm, ice_crystal, cosmic_stars, ocean_wave, butterfly_dance (insert before _build_effect_tags).
- Tag remaining presets in presets.json with effect_type/effect_config; update pyonfx_effects.json metadata accordingly.
- Quick manual preview/export smoke test for newly ported effects.

Phase 2 – Stabilize & Refactor (short/medium)
- Split pyonfx_effects.py into smaller modules (e.g., text_effects, particles, overlays) to reduce file size.
- Add shared helpers for common patterns (e.g., star/heart path constants, random jitter builders) to cut repetition.
- Add basic validation on effect_config (min/max clamping) before rendering.
- Ensure main.py dispatch lists are generated from a single source of truth (e.g., keys of pyonfx_effects.json) to avoid drift.

Phase 3 – Preset Management Quality of Life
- Add CLI or admin UI to edit presets.json and pyonfx_effects.json (create/update/delete) with schema validation.
- Add preset versioning or “draft/published” flags to avoid breaking active projects.
- Add import/export for single presets (JSON file) and batch ops for backup/restore.
- Improve screenshot flow (ensure presets screenshots stay in sync with preset updates).

Phase 4 – Testing & Regression Safety
- Add snapshot-based ASS regression tests for key presets (compare generated ASS strings or rendered frames) to catch visual drift.
- Add unit tests for helper utilities (e.g., color conversion, grouping, clip/paths) and effect_config validation.
- Optional: lightweight visual diff (ffmpeg -> images -> perceptual diff) for critical presets.

Phase 5 – Parametric/DSL Layer (reduce code writing)
- Define a JSON-based mini-DSL for common animations (fade/move/scale/rotate, particles, shapes) so new presets can be added without touching Python.
- Implement a renderer that interprets this DSL into ASS lines using PyonFX helpers; progressively migrate simpler presets to DSL.

Phase 6 – Performance & Packaging
- Profile heavy particle presets; add config knobs (particle_count caps) and random seed options for determinism.
- Package fonts and preset assets; ensure PyonFX dependencies are pinned and documented.
- Add caching/reuse for measured font widths if needed (avoid repeated PIL calls for the same font/size).

Phase 7 – Nice-to-Haves
- Add interactive preview controls: seed toggle, intensity sliders, particle count limiter.
- Add analytics/telemetry (opt-in) for most used presets/effects to prioritize maintenance.
- Provide “safe defaults” per effect_type in pyonfx_effects.json for UI generation.
